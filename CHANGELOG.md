# Changelog

All notable changes to this project will be documented in this file.

## [3.0.0] - 2025-09-25

### Breaking
- AutoDIOptimizer 읽기 API 일원화 및 표면 축소
  - AutoDIOptimizer의 다수 읽기용 nonisolated(static) API를 내부화(internal) 또는 Deprecated로 전환했습니다.
  - 외부에서는 UnifiedDI/DIContainer의 동기 헬퍼(스냅샷 기반)만 사용하세요.
  - 내부 동작(자동 수집/최적화)은 동일하며, 공용 읽기 경로만 통일되었습니다.
- AutoMonitor 동일 글로벌 액터로 정렬
  - AutoMonitor를 @DIActor로 통일하여 내부 hop을 제거했습니다. 외부 API 시그니처는 동일합니다.

### Added
- Benchmarks 실행 타깃 추가(간단 벤치 템플릿)
  - Target: Benchmarks (swift run -c release Benchmarks)
  - 인자: --count 10k/100k/1M, --debounce 50/100/200, --quick
  - p50/p95/p99 및 total(ms) 출력
- DocC/README 문서 보강
  - Bootstrap 가이드 추가(동기/비동기/혼합/조건부/보장/테스트)
  - Deprecated 읽기 API → 대체 경로 표 추가
- 디바운스 설정 노출
  - UnifiedDI.configureOptimization(debounceMs:)로 AutoDIOptimizer 디바운스 간격 제어(50~1000ms)

### Changed
- 읽기 경로 완전 일원화(스냅샷 기반 동기 반환)
  - UnifiedDI/DIContainer에서 autoGraph/optimizedTypes/circularDependencies/stats/isOptimized가 스냅샷에서 즉시 반환되도록 간소화
- 핫패스 fire-and-forget
  - register/resolve 추적은 비차단 전송(Task { @DIActor in ... })으로 전환 → p95/p99 지연 개선에 유리
- 스냅샷/그래프 갱신 디바운스(기본 100ms)
  - 대량 호출 시 CPU/로그 부하 감소
- 로깅 레벨 설정 일관성 개선
  - UnifiedDI.setLogLevel은 먼저 스냅샷을 즉시 갱신 후 액터에 위임(테스트/동기 읽기 일관성 향상)

### Removed
- DocC의 미사용/구 문서 제거
  - BootstrapRationale.md, BootstrapSystem.md, DocumentationStandards.md 삭제
- 플러그인 시스템 관련 톱페이지 섹션 제거(기능 비노출)

### Fixed
- “No 'async' operations occur within 'await' expression” 경고 제거(비동기 경로 정리, fire-and-forget 조정)
- 테스트 안정성 개선
  - 스냅샷 반영 대기를 폴링(waitUntil/waitAsyncUntil)으로 통일
  - 전체 테스트 통과 확인

### [2.3.0] - 2025-09-25

### Breaking
- DIContainer 동기화 변경
  - DIContainer.getAutoGeneratedGraph(), getOptimizedTypes(), getDetectedCircularDependencies(), getUsageStatistics(), isAutoOptimized(_:)가 동기 함수로 변경됨. 호출부의 await 제거 필요. 파일: Sources/Core/Container/DIContainer.swift:536
- UnifiedDI 동기화 변경
  - UnifiedDI.autoGraph(), optimizedTypes(), circularDependencies(), stats(), isOptimized(_:)가 동기 함수로 변경됨. 호출부의 await 제거 필요. 파일: Sources/Core/API/UnifiedDI.swift:318

### Added
- 동기 접근용 로깅 레벨 프로퍼티 추가: UnifiedDI.logLevel. 파일: Sources/Core/API/UnifiedDI.swift:393
- 그래프 시각화에 “등록된 노드(타입)” 출력 추가. 파일: Sources/Core/Auto/AutoDIOptimizer.swift:270

### Changed
- AutoDIOptimizer 스레드 안전화
  - NSLock 기반 내부 상태 보호 및 스냅샷 접근 도입(등록/해결/그래프/통계/순환 탐지). 파일: Sources/Core/Auto/AutoDIOptimizer.swift:31
  - getCurrentLogLevel()이 실제 설정 값을 반환하도록 수정. 파일: Sources/Core/Auto/AutoDIOptimizer.swift:100
  - trackResolution(_:)가 최적화 비활성화 상태에서도 사용 통계를 항상 집계하도록 변경(최적화 제안만 비활성화). 파일: Sources/Core/Auto/AutoDIOptimizer.swift:63

### Fixed
- 동시성 접근 시 간헐적 크래시(EXC_BAD_ACCESS) 해결: AutoDIOptimizer 내부 데이터 경쟁 제거. 파일: Sources/Core/Auto/AutoDIOptimizer.swift
- “No 'async' operations occur within 'await' expression” 경고 제거: 동기 함수로 시그니처 정리. 파일: Sources/Core/Container/DIContainer.swift:536, Sources/Core/API/UnifiedDI.swift:318
- “Result of call to 'registerIf' is unused” 경고 제거: @discardableResult 추가. 파일: Sources/Core/API/UnifiedDI.swift:302

## [2.2.0] - 2025-09-24

### Added
- Visualizer 비동기 API 추가: generateDOTGraphAsync / generateMermaidGraphAsync / generateASCIIGraphAsync / generateJSONGraphAsync
- 실시간 그래프 업데이트 토글 API: AutoDIOptimizer.shared.setRealtimeGraphEnabled(Bool) (기본 true)
- 프리웜 보조: AutoDIOptimizer.topUsedTypes(limit:) 추가

### Changed
- Visualizer 완전 async 전환: exportGraph는 내부 브리지로 async API 호출
- 문서(CoreAPIs.md) 예제를 async 기반으로 갱신
- UnifiedRegistry 완전 async 해석으로 전환; 내부 순환탐지 기록을 await로 직접 호출하여 오버헤드 제거
- @unchecked Sendable 최소화: ValueBox를 Sendable(value: any Sendable)로 변경, 제네릭 제약(where T: Sendable) 정비
- 실시간 그래프 업데이트 동작: off 시 실시간 동기화 중지, on 시 즉시 1회 동기화 후 100ms 디바운스로 재개
- 그래프 업데이트 최적화: updateGraph를 diff 기반(추가/제거 엣지) + 100ms 디바운스로 성능 개선

### Removed
- Visualizer 동기 생성 API 제거 (메이저 변경)
- UnifiedRegistry 동기 해석 API 제거(메이저): resolve(:) / resolveAny(:) / resolveAnyBox(_:) / resolve(keyPath:)

## [2.1.0] - 2024-09-24

### Added
- AutoDIOptimizer: 자동 의존성 그래프 생성 및 성능 최적화 시스템
- 자동 사용 통계 수집 및 백그라운드 최적화 (30초 주기)
- 자동 순환 의존성 감지 및 LogMacro 통합 로깅
- Swift DocC 문서 업데이트 (AutoDIOptimizer.md 추가)

### Changed
- 핵심 3개 PropertyWrapper로 단순화: @Inject, @Factory, @SafeInject
- DIContainer 통합: DependencyContainer + Container → DIContainer
- README 간소화: 핵심 기능 중심으로 재작성

### Removed
- PluginSystem (438라인) - 핵심 DI 기능에 집중
- InteractiveDependencyVisualizer (1022라인) - 자동화로 대체
- AdvancedCircularDependencyDetector (920라인) - AutoDIOptimizer로 통합
- ActorHopMetrics (399라인) - 불필요한 복잡성 제거
- DocumentationValidator (392라인) - 개발 도구 분리
- SimplePerformanceOptimizer - AutoDIOptimizer로 교체
- AutoDependencyResolver - 사용되지 않는 기능 제거 (1323라인)

## [2.0.0] - 2025-09-14

### Added
- UnifiedDI: 단일 진입점 등록/해결 API 추가 (sync/async 통합 경험)
- UnifiedRegistry: 통합 레지스트리(싱글톤/동기/비동기 팩토리, KeyPath 매핑)
- resolveAnyAsync(Any.Type): 런타임 타입 비동기 해석 API
- CI 파이프라인: 엄격 동시성 + 경고 실패 처리 + DocC 빌드 체크

### Changed
- 타입/동시성 안전성 강화: Swift 6 @Sendable, actor 격리, 박싱 최소화
- TypeNameResolver: 문자열 매핑 축소(명시적 등록/AutoResolve 우선)
- README/MIGRATION 업데이트: UnifiedDI, AutoResolver, 마이그레이션 가이드 보강

### Deprecated/Removed
- 문자열 기반 공통 타입 매핑 제거(취약성 감소)
- 일부 레거시 API를 UnifiedDI/UnifiedRegistry 기반으로 수렴

### Migration
- 상세 가이드는 MIGRATION-2.0.0.md 참고

---

이전 버전에 대한 변경 이력은 향후 정리 예정입니다.
